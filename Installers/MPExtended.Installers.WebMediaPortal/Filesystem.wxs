<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <!--
  Copyright (C) 2011 MPExtended Developers, http://mpextended.github.com/
  
  MPExtended is free software: you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation, either version 2 of the License, or
  (at your option) any later version.
  
  MPExtended is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
  GNU General Public License for more details.
  
  You should have received a copy of the GNU General Public License
  along with MPExtended. If not, see <http://www.gnu.org/licenses/>.
  -->
  <Fragment>
    <!-- Directory structure -->
    <Directory Id="TARGETDIR" Name="SourceDir">
      <!-- Program files -->
      <Directory Id="ProgramFilesFolder">
        <Directory Id="MPEXTENDEDDIRECTORY" Name="MPExtended">
          <Directory Id="InstallDirectory" Name="WebMediaPortal">
            <!-- General registry (installation path) -->
            <Component Id="Component_Registry" Guid="76089ff3-ddd3-4370-b2b8-d57de76b238e">
              <RegistryKey Root="HKLM" Key="Software\MPExtended" Action="createAndRemoveOnUninstall">
                <RegistryValue Type="string" Name="WebMediaPortalInstallLocation" Value="[MPEXTENDEDDIRECTORY]WebMediaPortal" />
              </RegistryKey>
            </Component>
            
            <Directory Id="BinDirectory" Name="bin">
              <!-- Binaries for WebMP -->
              <Component Id="Component_Binaries" Guid="0e795d5d-4cff-4dc9-b8e8-2a06c354f6f5">
                <File Source="$(var.MPExtended.Applications.WebMediaPortal.TargetDir)\WebMediaPortal.dll" />
                <File Source="$(var.MPExtended.Applications.WebMediaPortal.TargetDir)\MPExtended.Libraries.General.dll" />
                <File Source="$(var.MPExtended.Applications.WebMediaPortal.TargetDir)\MPExtended.Services.MediaAccessService.Interfaces.dll" />
                <File Source="$(var.MPExtended.Applications.WebMediaPortal.TargetDir)\MPExtended.Services.TVAccessService.Interfaces.dll" />
                <File Source="$(var.MPExtended.Applications.WebMediaPortal.TargetDir)\MPExtended.Services.StreamingService.Interfaces.dll" />
                <File Source="$(var.MPExtended.Applications.WebMediaPortal.TargetDir)\NLog.dll" />
                <File Source="$(var.MPExtended.Applications.WebMediaPortal.TargetDir)\NLog.config" />
              </Component>
            </Directory>
            
          </Directory>
        </Directory>
      </Directory>

      <!-- ProgramData -->
      <Directory Id="CommonAppDataFolder">
        <Directory Id="ConfigDirectory" Name="MPExtended">
          <!-- Config -->
          <Component Id="Component_Config" Guid="f28c66d5-93ec-49bb-8114-b2545970991b">
            <CreateFolder Directory="ConfigDirectory">
              <Permission User="Everyone" GenericAll="yes" CreateFile="yes" />
            </CreateFolder>
            <File Source="$(var.SolutionDir)\Config\Release\WebMediaPortal.xml">
              <Permission User="Everyone" GenericAll="yes" Write="yes" />
            </File>
            <File Source="$(var.SolutionDir)\Config\Release\WebMediaPortalUsers.xml">
              <Permission User="Everyone" GenericAll="yes" Write="yes" />
            </File>
          </Component>

          <Directory Id="LogDirectory" Name="Logs">
            <!-- set directory permissions-->
            <Component Id="Component_Logs" Guid="04ae34a1-f0c6-41b0-baa7-6161b48464c2">
              <CreateFolder Directory="LogDirectory">
                <Permission User="Everyone" GenericAll="yes" CreateFile="yes" />
              </CreateFolder>
            </Component>
          </Directory>
        </Directory>
      </Directory>
    </Directory>
  </Fragment>
</Wix>